<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <title>BS Plugins Diff</title>
</head>
<body>
<div id="input">
    <h2>Input</h2>
    <div>
        <label for="plugins_old">Old Plugins Folder</label>
        <br/>
        <input type="file" id="plugins_old" name="plugins_old" webkitdirectory directory/>
    </div>
    <br/>
    <div>
        <label for="plugins_new">New Plugins Folder</label>
        <br/>
        <input type="file" id="plugins_new" name="plugins_new" webkitdirectory directory/>
    </div>
    <br/>
    <button id="check" onclick="check()">Check</button>
    <br/>
    <hr/>
    <div>
        <h2>Results</h2>
        <ul id="results">

        </ul>
    </div>
</div>
<script type="application/javascript">
    let plugins_old = null;
    let plugins_new = null;

    document.getElementById("plugins_old").addEventListener("change", function (event) {
        plugins_old = event.target.files;
    }, false);
    document.getElementById("plugins_new").addEventListener("change", function (event) {
        plugins_new = event.target.files;
    }, false);

    function check() {
        let missingFileNames = Array.from(plugins_old).map(file => file.name);
        missingFileNames = missingFileNames.filter(plugin => plugin.endsWith(".dll"));

        Array.from(plugins_new).map(file => file.name)
            .forEach(plugin => missingFileNames = missingFileNames.filter(oldPlugin => oldPlugin !== plugin));

        let newFileNames = Array.from(plugins_new).map(file => file.name);
        newFileNames = newFileNames.filter(plugin => plugin.endsWith(".dll"));

        Array.from(plugins_old).map(file => file.name)
        .forEach(plugin => newFileNames = newFileNames.filter(newPlugin => newPlugin !== plugin));

        document.getElementById("results").innerHTML = "";

        missingFileNames.forEach(missingPlugin => {
            let result = document.createElement("li");
            result.innerText = missingPlugin;
            result.style.color = "#FF0000";
            document.getElementById("results").append(result);
        });

        newFileNames.forEach(missingPlugin => {
            let result = document.createElement("li");
            result.innerText = missingPlugin;
            result.style.color = "#00FF00";
            document.getElementById("results").append(result);
        });
    }

</script>
</body>
</html>
